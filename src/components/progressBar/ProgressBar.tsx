import { useState, useEffect } from 'react'
import useCustomMediaQuery from '../../hooks/useMediaQuery'

export default function ProgressBar({
  currentActivity = 0,
  totalActivities = 1,
  height = 88
}: {
  currentActivity?: number
  totalActivities?: number
  height?: number
}) {
  const [progress, setProgress] = useState(0)
  const { isDesktop } = useCustomMediaQuery()
  const width = isDesktop ? 400 : 300

  useEffect(() => {
    const newProgress = Math.min(Math.max((currentActivity / totalActivities) * 100, 0), 100)
    setProgress(newProgress)
  }, [currentActivity, totalActivities])

  return (
    <svg
      width={width}
      height={height}
      viewBox="0 0 401 88"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      role="img"
      aria-valuemin={0}
      aria-valuemax={100}
      aria-valuenow={progress}
      aria-label={`Progress: ${progress.toFixed(0)}%`}
    >
      <defs>
        <linearGradient id="progress-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset={`${progress}%`} stopColor="#f2c160" />
          <stop offset={`${progress}%`} stopColor="#E7E7E7" />
        </linearGradient>
        <mask id="progress-mask">
          <path
            d="M100.025 86.1C98.6376 86.1 97.4517 85.61 96.4667 84.63C95.4818 83.65 94.9893 82.43 94.9893 80.98V6.12C94.9893 4.67 95.4818 3.45 96.4667 2.47C97.4517 1.49 98.6376 1 100.025 1C101.482 1 102.708 1.49 103.693 2.47C104.678 3.45 105.17 4.67 105.17 6.12V76.08H146.126C147.513 76.08 148.719 76.55 149.744 77.5C150.769 78.44 151.282 79.64 151.282 81.1C151.282 82.56 150.769 83.66 149.744 84.64C148.719 85.62 147.513 86.11 146.126 86.11H100.015L100.025 86.1Z"
            fill="white"
          />
          <path
            d="M171.222 86.31C169.322 86.31 167.895 85.51 166.95 83.91C166.005 82.31 165.925 80.64 166.729 78.9L198.046 4.68995C198.991 2.36995 200.599 1.19995 202.86 1.19995C205.272 1.19995 206.911 2.35995 207.785 4.68995L239.213 79.12C239.946 80.86 239.816 82.5 238.831 84.02C237.846 85.5499 236.398 86.31 234.509 86.31C233.564 86.31 232.65 86.04 231.775 85.49C230.901 84.95 230.238 84.17 229.805 83.15L201.443 13.85H204.619L176.036 83.15C175.593 84.24 174.94 85.04 174.066 85.55C173.191 86.06 172.237 86.31 171.222 86.31ZM177.573 67.03L181.624 58.4199H225.102L229.042 67.03H177.563H177.573Z"
            fill="white"
          />
          <path
            d="M37.5713 24.64H37.2095C35.7275 24.64 34.5261 25.8354 34.5261 27.31V60.22C34.5261 61.6946 35.7275 62.89 37.2095 62.89H37.5713C39.0534 62.89 40.2548 61.6946 40.2548 60.22V27.31C40.2548 25.8354 39.0534 24.64 37.5713 24.64Z"
            fill="white"
          />
          <path
            d="M54.0641 34.74H53.7023C52.2202 34.74 51.0188 35.9354 51.0188 37.41V50.11C51.0188 51.5846 52.2202 52.78 53.7023 52.78H54.0641C55.5461 52.78 56.7475 51.5846 56.7475 50.11V37.41C56.7475 35.9354 55.5461 34.74 54.0641 34.74Z"
            fill="white"
          />
          <path
            d="M29.32 33.28H28.9582C27.4761 33.28 26.2747 34.4754 26.2747 35.95V51.56C26.2747 53.0346 27.4761 54.23 28.9582 54.23H29.32C30.802 54.23 32.0034 53.0346 32.0034 51.56V35.95C32.0034 34.4754 30.802 33.28 29.32 33.28Z"
            fill="white"
          />
          <path
            d="M77.3006 62.82C78.1247 64.25 78.1247 65.95 77.3006 67.37C74.396 72.31 70.4965 76.4 65.7225 79.52C59.0792 83.84 51.059 86.04 41.893 86.04C34.3049 86.04 27.3199 84.22 21.159 80.65C20.9681 81.11 20.5861 81.48 20.0434 81.63L11.4905 84L2.99793 86.64C1.77178 87.02 0.696385 85.94 1.0783 84.73L3.74166 76.28L6.1236 67.77C6.26431 67.25 6.63617 66.87 7.07839 66.67C6.86733 66.32 6.66633 65.98 6.46532 65.62C2.90747 59.24 1.0984 51.9 1.0984 43.81C1.0984 35.72 2.90747 28.35 6.46532 21.94C8.24424 18.74 10.3749 15.87 12.8172 13.34C15.2695 10.82 18.0434 8.65997 21.1389 6.86997C27.3199 3.28997 34.2949 1.46997 41.883 1.46997C51.1293 1.46997 59.1697 3.67997 65.7828 8.04997C70.5467 11.21 74.4362 15.35 77.3307 20.37C78.1549 21.8 78.1549 23.5 77.3307 24.93C76.4966 26.36 75.0091 27.2 73.3608 27.2H72.8583C71.1397 27.2 69.5718 26.23 68.7577 24.67C66.4763 20.29 63.2602 16.74 59.1898 14.1C54.446 11.03 48.6167 9.46997 41.893 9.46997C35.9432 9.46997 30.5159 10.88 25.7621 13.64C21.0183 16.4 17.2394 20.43 14.5358 25.63C11.8322 30.83 10.4553 36.94 10.4553 43.81C10.4553 50.68 11.8322 56.78 14.5358 61.93C17.2394 67.08 21.0183 71.1 25.7621 73.86C30.5159 76.62 35.9432 78.02 41.893 78.02C48.6268 78.02 54.4359 76.48 59.1898 73.45C63.2602 70.86 66.4763 67.35 68.7577 63.03C69.5718 61.49 71.1397 60.53 72.8282 60.53H73.3508C75.0091 60.53 76.4865 61.38 77.3106 62.81L77.3006 62.82Z"
            fill="white"
          />
        </mask>
      </defs>
      <g mask="url(#progress-mask)">
        <rect width={width} height={height} fill="url(#progress-gradient)" />
      </g>
      <path
        d="M100.025 86.1C98.6376 86.1 97.4517 85.61 96.4667 84.63C95.4818 83.65 94.9893 82.43 94.9893 80.98V6.12C94.9893 4.67 95.4818 3.45 96.4667 2.47C97.4517 1.49 98.6376 1 100.025 1C101.482 1 102.708 1.49 103.693 2.47C104.678 3.45 105.17 4.67 105.17 6.12V76.08H146.126C147.513 76.08 148.719 76.55 149.744 77.5C150.769 78.44 151.282 79.64 151.282 81.1C151.282 82.56 150.769 83.66 149.744 84.64C148.719 85.62 147.513 86.11 146.126 86.11H100.015L100.025 86.1Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M171.222 86.31C169.322 86.31 167.895 85.51 166.95 83.91C166.005 82.31 165.925 80.64 166.729 78.9L198.046 4.68995C198.991 2.36995 200.599 1.19995 202.86 1.19995C205.272 1.19995 206.911 2.35995 207.785 4.68995L239.213 79.12C239.946 80.86 239.816 82.5  238.831 84.02C237.846 85.5499 236.398 86.31 234.509 86.31C233.564 86.31 232.65 86.04 231.775 85.49C230.901 84.95 230.238 84.17 229.805 83.15L201.443 13.85H204.619L176.036 83.15C175.593 84.24 174.94 85.04 174.066 85.55C173.191 86.06 172.237 86.31 171.222 86.31ZM177.573 67.03L181.624 58.4199H225.102L229.042 67.03H177.563H177.573Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M260.69 86.31C259.233 86.31 258.007 85.82 257.022 84.84C256.037 83.86 255.545 82.64 255.545 81.19V6.32996C255.545 4.79996 256.037 3.56996 257.022 2.62996C258.007 1.68996 259.233 1.20996 260.69 1.20996H280.731C286.138 1.20996 290.932 2.33996 295.133 4.58996C299.334 6.83996 302.621 9.96996 304.993 13.96C307.364 17.96 308.55 22.57 308.55 27.8C308.55 32.74 307.364 37.14 304.993 40.99C302.621 44.84 299.334 47.85 295.133 50.03C290.932 52.21 286.138 53.3 280.731 53.3H265.836V81.2C265.836 82.65 265.364 83.87 264.409 84.85C263.464 85.83 262.218 86.32 260.69 86.32V86.31ZM265.836 43.71H280.731C284.238 43.71 287.314 43.04 289.987 41.69C292.651 40.35 294.751 38.46 296.289 36.02C297.827 33.59 298.59 30.84 298.59 27.79C298.59 24.45 297.827 21.49 296.289 18.91C294.751 16.33 292.661 14.33 289.987 12.92C287.324 11.5 284.238 10.8 280.731 10.8H265.836V43.71ZM306.249 86.31C305.304 86.31 304.46 86.11 303.726 85.71C302.993 85.31 302.339 84.67 301.756 83.8L281.605 51.55L291.686 48.72L310.309 78.47C311.545 80.43 311.736 82.23 310.852 83.86C309.978 85.49 308.44 86.31 306.249 86.31Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M331.304 86.31C329.405 86.31 327.978 85.51 327.033 83.91C326.088 82.31 326.008 80.64 326.812 78.9L358.139 4.68995C359.084 2.36995 360.692 1.19995 362.953 1.19995C365.365 1.19995 367.004 2.35995 367.878 4.68995L399.306 79.12C400.039 80.86 399.909 82.5 398.924 84.02C397.939 85.5499 396.491 86.31 394.602 86.31C393.647 86.31 392.743 86.04 391.868 85.49C390.994 84.9399 390.331 84.17 389.898 83.15L361.536 13.85H364.712L336.129 83.15C335.686 84.24 335.033 85.04 334.159 85.55C333.284 86.06 332.33 86.31 331.314 86.31H331.304ZM337.656 67.03L341.707 58.4199H385.185L389.124 67.03H337.646H337.656Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M45.8126 29.28H45.4508C43.9688 29.28 42.7673 30.4754 42.7673 31.95V55.58C42.7673 57.0546 43.9688 58.25 45.4508 58.25H45.8126C47.2946 58.25 48.4961 57.0546 48.4961 55.58V31.95C48.4961 30.4754 47.2946 29.28 45.8126 29.28Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M37.5713 24.64H37.2095C35.7275 24.64 34.5261 25.8354 34.5261 27.31V60.22C34.5261 61.6946 35.7275 62.89 37.2095 62.89H37.5713C39.0534 62.89 40.2548 61.6946 40.2548 60.22V27.31C40.2548 25.8354 39.0534 24.64 37.5713 24.64Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M54.0641 34.74H53.7023C52.2202 34.74 51.0188 35.9354 51.0188 37.41V50.11C51.0188 51.5846 52.2202 52.78 53.7023 52.78H54.0641C55.5461 52.78 56.7475 51.5846 56.7475 50.11V37.41C56.7475 35.9354 55.5461 34.74 54.0641 34.74Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M29.32 33.28H28.9582C27.4761 33.28 26.2747 34.4754 26.2747 35.95V51.56C26.2747 53.0346 27.4761 54.23 28.9582 54.23H29.32C30.802 54.23 32.0034 53.0346 32.0034 51.56V35.95C32.0034 34.4754 30.802 33.28 29.32 33.28Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
      <path
        d="M77.3006 62.82C78.1247 64.25 78.1247 65.95 77.3006 67.37C74.396 72.31 70.4965 76.4 65.7225 79.52C59.0792 83.84 51.059 86.04 41.893 86.04C34.3049 86.04 27.3199 84.22 21.159 80.65C20.9681 81.11 20.5861 81.48 20.0434 81.63L11.4905 84L2.99793 86.64C1.77178 87.02 0.696385 85.94 1.0783 84.73L3.74166 76.28L6.1236 67.77C6.26431 67.25 6.63617 66.87 7.07839 66.67C6.86733 66.32 6.66633 65.98 6.46532 65.62C2.90747 59.24 1.0984 51.9 1.0984 43.81C1.0984 35.72 2.90747 28.35 6.46532 21.94C8.24424 18.74 10.3749 15.87 12.8172 13.34C15.2695 10.82 18.0434 8.65997 21.1389 6.86997C27.3199 3.28997 34.2949 1.46997 41.883 1.46997C51.1293 1.46997 59.1697 3.67997 65.7828 8.04997C70.5467 11.21 74.4362 15.35 77.3307 20.37C78.1549 21.8 78.1549 23.5 77.3307 24.93C76.4966 26.36 75.0091 27.2 73.3608 27.2H72.8583C71.1397 27.2 69.5718 26.23 68.7577 24.67C66.4763 20.29 63.2602 16.74 59.1898 14.1C54.446 11.03 48.6167 9.46997 41.893 9.46997C35.9432 9.46997 30.5159 10.88 25.7621 13.64C21.0183 16.4 17.2394 20.43 14.5358 25.63C11.8322 30.83 10.4553 36.94 10.4553 43.81C10.4553 50.68 11.8322 56.78 14.5358 61.93C17.2394 67.08 21.0183 71.1 25.7621 73.86C30.5159 76.62 35.9432 78.02 41.893 78.02C48.6268 78.02 54.4359 76.48 59.1898 73.45C63.2602 70.86 66.4763 67.35 68.7577 63.03C69.5718 61.49 71.1397 60.53 72.8282 60.53H73.3508C75.0091 60.53 76.4865 61.38 77.3106 62.81L77.3006 62.82Z"
        stroke="#E7E7E7"
        strokeMiterlimit="10"
      />
    </svg>
  )
}
